---
eip: 5994
title: Token Balance Update Hooks (Pods)
description: Extends EIP-20, EIP-721, EIP-1155 token standards to enable opt-in balance tracking by external contracts (Pods)
author: Anton Bukov (@k06a), Mikhail Melnik (@zumzoom)
discussions-to: https://ethereum-magicians.org/t/eip-5994-token-balance-update-hooks-pods-for-erc20-erc721-erc1155/11782
status: Draft
type: Standards Track
category: ERC
created: 2022-11-18
requires: 20, 721, 1155
---

## Abstract

"Token Pods" are smart contracts that users can opt-in to that track balance changes. This EIP defines an interface for pods. In addition, this EIP extends the [EIP-20](./eip-20.md), [EIP-721](./eip-721.md), and [EIP-1155](./eip-1155.md) interfaces to add support for pods.

## Motivation

This concept of Pods allows to extend the logic of tokens in the most permissionless and risk-free way. Almost arbitrary logical extensions are possible: incentives for farmers, delegation of rights, voting, etc.

## Specification

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119.

```solidity
interface IPod {
    function updateBalances(address from, address to, uint256 amount) external;
}

interface IERC20Pods is IERC20 {
    function hasPod(address account, address pod) external view returns(bool);
    function podsCount(address account) external view returns(uint256);
    function podAt(address account, uint256 index) external view returns(address);
    function pods(address account) external view returns(address[] memory);
    function podBalanceOf(address pod, address account) external view returns(uint256);

    function addPod(address pod) external;
    function removePod(address pod) external;
    function removeAllPods() external;
}

interface IERC721Pods is IERC721 {
    function hasPod(address account, address pod) external view returns(bool);
    function podsCount(address account) external view returns(uint256);
    function podAt(address account, uint256 index) external view returns(address);
    function pods(address account) external view returns(address[] memory);
    function podBalanceOf(address pod, address account) external view returns(uint256);

    function addPod(address pod) external;
    function removePod(address pod) external;
    function removeAllPods() external;
}
```

### Pod specification

- Pod MUST implement interface `IPod` and fit execution of `updateBalances` method in 200,000 gas and never revert.

- Pod SHOULD make sure `updateBalances(...)` method was triggered by `token` it was designated for.

- Pod can track changes of balances of users who voluntarily added this pod, all other account will be represented as `address(0)` and interactions with such accounts could be considered as mints and burns.

- Pod SHOULD NOT try to change balances of the token it was designated for, since it would introduce reentrancy, which will not pass.

## Rationale

## Backwards Compatibility

Fully backward compatibile with ERC20 and ERC721.

## Security Considerations

Pods implementations will never block balance update, but can eat upto 200,000 gas. Number of added Pods per account is limited to some immutable value (reasonable amount taking into account max transaction gas limit).

## Copyright

Copyright and related rights waived viaÂ [CC0](../LICENSE.md).
